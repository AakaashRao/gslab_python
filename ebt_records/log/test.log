test_bad (test_save_data.test) ... ok
test_good (test_save_data.test) ... ok
test_build_numeric_key (test_ebt_records_tools.test) ... ok
test_drop_all_duplicates (test_ebt_records_tools.test) ... ok
test_drop_duplicates (test_ebt_records_tools.test) ... ok
test_mask_id (test_ebt_records_tools.test) ... ok

----------------------------------------------------------------------
Ran 6 tests in 27.989s

OK
File type must be 'hdf5', 'csv' or 'dta'

==================================================================================================
File: ../output/test_good.csv
Key: id1 id2
==================================================================================================
               count       mean        std         min        max
id1               10        NaN        NaN         NaN        NaN
id2               10          2   1.490712           0          4
var1              10  0.5015276  0.3051978  0.05573807  0.9223103
var2              10  0.5671285  0.3275632  0.09517288  0.9700129
var3              10  0.5073963  0.3400039   0.1118694  0.9070628
non_unique_key    10          1          0           1          1
key_with_nas       5          2   1.581139           0          4



==================================================================================================
File: ../output/test_good.csv
Key: id1 id2
==================================================================================================
               count       mean        std         min        max
id1               10        NaN        NaN         NaN        NaN
id2               10          2   1.490712           0          4
var1              10  0.5015276  0.3051978  0.05573807  0.9223103
var2              10  0.5671285  0.3275632  0.09517288  0.9700129
var3              10  0.5073963  0.3400039   0.1118694  0.9070628
non_unique_key    10          1          0           1          1
key_with_nas       5          2   1.581139           0          4



==================================================================================================
File: ../output/test_good.h5
Key: id1 id2
Store key: test_hdf
==================================================================================================
               count       mean        std         min        max
id1               10        NaN        NaN         NaN        NaN
id2               10          2   1.490712           0          4
var1              10  0.5015276  0.3051978  0.05573807  0.9223103
var2              10  0.5671285  0.3275632  0.09517288  0.9700129
var3              10  0.5073963  0.3400039   0.1118694  0.9070628
non_unique_key    10          1          0           1          1
key_with_nas       5          2   1.581139           0          4



==================================================================================================
File: ../temp/test_good.csv
Key: id1 id2
==================================================================================================
               count       mean        std         min        max
id1               10        NaN        NaN         NaN        NaN
id2               10          2   1.490712           0          4
var1              10  0.5015276  0.3051978  0.05573807  0.9223103
var2              10  0.5671285  0.3275632  0.09517288  0.9700129
var3              10  0.5073963  0.3400039   0.1118694  0.9070628
non_unique_key    10          1          0           1          1
key_with_nas       5          2   1.581139           0          4



==================================================================================================
File: ../output/test_good.dta
Key: id1 id2
==================================================================================================
               count       mean        std         min        max
id1               10        NaN        NaN         NaN        NaN
id2               10          2   1.490712           0          4
var1              10  0.5015276  0.3051978  0.05573807  0.9223103
var2              10  0.5671285  0.3275632  0.09517288  0.9700129
var3              10  0.5073963  0.3400039   0.1118694  0.9070628
non_unique_key    10          1          0           1          1
key_with_nas       5          2   1.581139           0          4



==================================================================================================
File: ../output/test_good.csv
Key: id1 id2
==================================================================================================
               count       mean        std         min        max
id1               10        NaN        NaN         NaN        NaN
id2               10          2   1.490712           0          4
var1              10  0.5015276  0.3051978  0.05573807  0.9223103
var2              10  0.5671285  0.3275632  0.09517288  0.9700129
var3              10  0.5073963  0.3400039   0.1118694  0.9070628
non_unique_key    10          1          0           1          1
key_with_nas       5          2   1.581139           0          4



==================================================================================================
File: ../output/categorical_lookup.h5
Key: categorical_key
Store key: categorical
==================================================================================================
                count mean        std  min  max
categorical_key     2  0.5  0.7071068    0    1
categorical         2  NaN        NaN  NaN  NaN



5 observations deleted
0 observations deleted
3 observations deleted
0 observations deleted
